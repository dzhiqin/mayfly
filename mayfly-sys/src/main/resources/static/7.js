(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{190:function(e,t){e.exports=function(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}},203:function(e,t,s){var i=s(38),a=s(226);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var n={insert:"head",singleton:!1},r=(i(e.i,a,n),a.locals?a.locals:{});e.exports=r},206:function(e,t,s){"use strict";var i=s(190),a=s.n(i);function n(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,i)}return s}function r(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?n(Object(s),!0).forEach((function(t){a()(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):n(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}var o={name:"DynamicForm",props:{formInfo:Object,formData:[Object,Boolean]},data:function(){return{form:{}}},watch:{formData:{handler:function(){this.formData&&(this.form=r({},this.formData))},deep:!0}},methods:{submit:function(){var e=this;this.$refs.dynamicForm.validate((function(t){if(!t)return!1;var s=e.form.id?e.formInfo.updatePermission:e.formInfo.addPermission;s?s.request(e.form).then((function(t){e.$message.success("保存成功"),e.$emit("submitSuccess"),e.cancel()})):e.$message.error("表单未设置对应的提交操作")}))},cancel:function(){var e=this;this.$emit("cancel"),setTimeout((function(){e.$refs.dynamicForm.resetFields(),e.form={}}),300)}},mounted:function(){this.form=r({},this.formData)}},l=s(67),c=Object(l.a)(o,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"dynamic-form"},[s("el-form",{ref:"dynamicForm",attrs:{model:e.form,"label-width":e.formInfo.labelWidth?e.formInfo.labelWidth:"80px",size:e.formInfo.size?e.formInfo.size:"small"}},[e._l(e.formInfo.formItems,(function(t){return s("el-form-item",{key:t.key,attrs:{prop:t.name,label:t.label,required:t.required,rules:t.rules}},["input"===t.type?s("el-input",{attrs:{placeholder:t.placeholder,type:t.inputType,clearable:"",autocomplete:"new-password"},model:{value:e.form[t.name],callback:function(s){e.$set(e.form,t.name,"string"==typeof s?s.trim():s)},expression:"form[item.name]"}}):"select"===t.type?s("el-select",{attrs:{placeholder:t.placeholder,clearable:""},model:{value:e.form[t.name],callback:function(s){e.$set(e.form,t.name,"string"==typeof s?s.trim():s)},expression:"form[item.name]"}},e._l(t.enums,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):e._e()],1)})),e._v(" "),s("el-form-item",{attrs:{size:"large"}},[s("el-button",{attrs:{size:"mini"},on:{click:e.cancel}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.submit}},[e._v("确 定")])],1)],2)],1)}),[],!1,null,null,null).exports,u={name:"DynamicFormDialog",props:{visible:Boolean,dialogWidth:String,title:String,formInfo:Object,formData:[Object,Boolean]},methods:{cancel:function(){this.$emit("cancel")},submitSuccess:function(){this.$emit("submitSuccess")}},mounted:function(){},components:{DynamicForm:c}},m=Object(l.a)(u,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"form-dialog"},[s("el-dialog",{attrs:{title:e.title,visible:e.visible,"show-close":!1,width:e.dialogWidth?e.dialogWidth:"500px"}},[s("dynamic-form",{attrs:{"form-info":e.formInfo,"form-data":e.formData},on:{submitSuccess:e.submitSuccess,cancel:e.cancel}})],1)],1)}),[],!1,null,null,null);t.a=m.exports},225:function(e,t,s){"use strict";var i=s(203);s.n(i).a},226:function(e,t,s){(t=s(39)(!1)).push([e.i,"\n.row .title {\n  font-size: 12px;\n}\n.row .value {\n  font-size: 12px;\n  color: black;\n}\n",""]),e.exports=t},238:function(e,t,s){"use strict";s.r(t);var i,a=s(184),n=s.n(a),r=s(185),o=s.n(r),l=s(187),c=(s(40),{props:{visible:Boolean,info:Object},data:function(){return{name:""}},watch:{},methods:{close:function(){this.name="",this.$emit("close")}}}),u=(s(225),s(67)),m=Object(u.a)(c,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{attrs:{title:"info",visible:e.visible,"show-close":!0,width:"35%"},on:{close:function(t){return e.close()}}},[s("el-collapse",{model:{value:e.name,callback:function(t){e.name=t},expression:"name"}},[s("el-collapse-item",{attrs:{title:"Server(Redis服务器的一般信息)",name:"server"}},[s("div",{staticClass:"row"},[s("span",{staticClass:"title"},[e._v("redis_version(版本):")]),e._v(" "),s("span",{staticClass:"value"},[e._v(e._s(e.info.Server.redis_version))])]),e._v(" "),s("div",{staticClass:"row"},[s("span",{staticClass:"title"},[e._v("tcp_port(端口):")]),e._v(" "),s("span",{staticClass:"value"},[e._v(e._s(e.info.Server.tcp_port))])]),e._v(" "),s("div",{staticClass:"row"},[s("span",{staticClass:"title"},[e._v("redis_mode(模式):")]),e._v(" "),s("span",{staticClass:"value"},[e._v(e._s(e.info.Server.redis_mode))])]),e._v(" "),s("div",{staticClass:"row"},[s("span",{staticClass:"title"},[e._v("os(宿主操作系统):")]),e._v(" "),s("span",{staticClass:"value"},[e._v(e._s(e.info.Server.os))])]),e._v(" "),s("div",{staticClass:"row"},[s("span",{staticClass:"title"},[e._v("uptime_in_days(运行天数):")]),e._v(" "),s("span",{staticClass:"value"},[e._v(e._s(e.info.Server.uptime_in_days))])]),e._v(" "),s("div",{staticClass:"row"},[s("span",{staticClass:"title"},[e._v("executable(可执行文件路径):")]),e._v(" "),s("span",{staticClass:"value"},[e._v(e._s(e.info.Server.executable))])]),e._v(" "),s("div",{staticClass:"row"},[s("span",{staticClass:"title"},[e._v("config_file(配置文件路径):")]),e._v(" "),s("span",{staticClass:"value"},[e._v(e._s(e.info.Server.config_file))])])]),e._v(" "),s("el-collapse-item",{attrs:{title:"Clients(客户端连接部分)",name:"client"}},[s("div",{staticClass:"row"},[s("span",{staticClass:"title"},[e._v("connected_clients(已连接客户端数):")]),e._v(" "),s("span",{staticClass:"value"},[e._v(e._s(e.info.Clients.connected_clients))])])]),e._v(" "),s("el-collapse-item",{attrs:{title:"Memory(内存消耗相关信息)",name:"memory"}},[s("div",{staticClass:"row"},[s("span",{staticClass:"title"},[e._v("used_memory(分配内存总量):")]),e._v(" "),s("span",{staticClass:"value"},[e._v(e._s(e.info.Memory.used_memory_human))])]),e._v(" "),s("div",{staticClass:"row"},[s("span",{staticClass:"title"},[e._v("used_memory_rss(已分配的内存总量，操作系统角度):")]),e._v(" "),s("span",{staticClass:"value"},[e._v(e._s(e.info.Memory.used_memory_rss_human))])]),e._v(" "),s("div",{staticClass:"row"},[s("span",{staticClass:"title"},[e._v("mem_fragmentation_ratio(used_memory_rss和used_memory 之间的比率):")]),e._v(" "),s("span",{staticClass:"value"},[e._v(e._s(e.info.Memory.mem_fragmentation_ratio))])]),e._v(" "),s("div",{staticClass:"row"},[s("span",{staticClass:"title"},[e._v("used_memory_peak(内存消耗峰值):")]),e._v(" "),s("span",{staticClass:"value"},[e._v(e._s(e.info.Memory.used_memory_peak_human))])]),e._v(" "),s("div",{staticClass:"row"},[s("span",{staticClass:"title"},[e._v("total_system_memory(主机总内存):")]),e._v(" "),s("span",{staticClass:"value"},[e._v(e._s(e.info.Memory.total_system_memory_human))])])]),e._v(" "),s("el-collapse-item",{attrs:{title:"CPU",name:"cpu"}},[s("div",{staticClass:"row"},[s("span",{staticClass:"title"},[e._v("used_cpu_sys(由Redis服务器消耗的系统CPU):")]),e._v(" "),s("span",{staticClass:"value"},[e._v(e._s(e.info.CPU.used_cpu_sys))])]),e._v(" "),s("div",{staticClass:"row"},[s("span",{staticClass:"title"},[e._v("used_cpu_user(由Redis服务器消耗的用户CPU):")]),e._v(" "),s("span",{staticClass:"value"},[e._v(e._s(e.info.CPU.used_cpu_user))])]),e._v(" "),s("div",{staticClass:"row"},[s("span",{staticClass:"title"},[e._v("used_cpu_sys_children(由后台进程消耗的系统CPU):")]),e._v(" "),s("span",{staticClass:"value"},[e._v(e._s(e.info.CPU.used_cpu_sys_children))])]),e._v(" "),s("div",{staticClass:"row"},[s("span",{staticClass:"title"},[e._v("used_cpu_user_children(由后台进程消耗的用户CPU):")]),e._v(" "),s("span",{staticClass:"value"},[e._v(e._s(e.info.CPU.used_cpu_user_children))])])])],1)],1)],1)}),[],!1,null,null,null).exports,p=s(192),f=s(206),d={data:function(){return{redisTable:[],permission:p.a.redis,keyPermission:p.a.redisKey,currentId:null,currentData:null,form:{host:"",port:6379,password:""},params:{host:null,clusterId:null},redisInfo:{url:""},clusters:[{id:0,name:"单机"}],infoDialog:{visible:!1,info:{Server:{},Keyspace:{},Clients:{},CPU:{},Memory:{}}},formDialog:{visible:!1,title:null,formInfo:{addPermission:p.a.redis.save,updatePermission:p.a.redis.update,formItems:[{type:"input",label:"主机：",name:"host",placeholder:"请输入节点ip",rules:[{required:!0,message:"请输入节点ip",trigger:["blur","change"]}]},{type:"input",label:"端口号：",name:"port",placeholder:"请输入节点端口号",inputType:"number",rules:[{required:!0,message:"请输入节点端口号",trigger:["blur","change"]}]},{type:"input",label:"密码：",name:"pwd",placeholder:"请输入节点密码",inputType:"password"},{type:"input",label:"描述：",name:"description",placeholder:"请输入节点描述",inputType:"textarea"}]},formData:null}}},methods:{choose:function(e){e&&(this.currentId=e.id,this.currentData=e)},connect:function(){var e=this;Req.post("/open/redis/connect",this.form,(function(t){e.redisInfo=t}))},deleteNode:(i=o()(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.permission.del.request({id:this.currentId});case 2:this.$message.success("删除成功"),this.search();case 4:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)}),manage:function(e){this.$router.push("/redis_operation/".concat(e.clusterId,"/").concat(e.id))},info:function(e){var t=this;this.permission.info.request({id:e}).then((function(s){t.infoDialog.info=s,t.infoDialog.id=e,t.infoDialog.visible=!0}))},search:function(){var e=this;this.permission.list.request(this.params).then((function(t){e.redisTable=t}))},openFormDialog:function(e){var t;e?(this.formDialog.formData=this.currentData,t="编辑redis节点"):(this.formDialog.formData={port:6379},t="添加redis节点"),this.formDialog.title=t,this.formDialog.visible=!0},closeDialog:function(){this.formDialog.visible=!1,this.formDialog.formData=null},submitSuccess:function(){this.currentId=null,this.currentData=null,this.search()}},mounted:function(){this.search()},components:{ToolBar:l.a,Info:m,DynamicFormDialog:f.a}},v=Object(u.a)(d,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("ToolBar",[s("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini",plain:""},on:{click:function(t){return e.openFormDialog(!1)}}},[e._v("添加")]),e._v(" "),s("el-button",{attrs:{type:"primary",icon:"el-icon-edit",disabled:null==e.currentId,size:"mini",plain:""},on:{click:function(t){return e.openFormDialog(e.currentData)}}},[e._v("编辑")]),e._v(" "),s("el-button",{attrs:{type:"danger",icon:"el-icon-delete",disabled:null==e.currentId,size:"mini",plain:""},on:{click:e.deleteNode}},[e._v("删除")]),e._v(" "),s("div",{staticStyle:{float:"right"}},[s("el-input",{staticStyle:{width:"140px"},attrs:{placeholder:"host",size:"mini",plain:"",clearable:""},on:{clear:e.search},model:{value:e.params.host,callback:function(t){e.$set(e.params,"host",t)},expression:"params.host"}}),e._v(" "),s("el-select",{attrs:{size:"mini",clearable:"",placeholder:"集群选择"},model:{value:e.params.clusterId,callback:function(t){e.$set(e.params,"clusterId",t)},expression:"params.clusterId"}},e._l(e.clusters,(function(e){return s("el-option",{key:e.id,attrs:{value:e.id,label:e.name}})})),1),e._v(" "),s("el-button",{attrs:{type:"success",icon:"el-icon-search",size:"mini"},on:{click:e.search}})],1)],1),e._v(" "),s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.redisTable,stripe:""},on:{"current-change":e.choose}},[s("el-table-column",{attrs:{label:"选择",width:"50px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-radio",{attrs:{label:t.row.id},model:{value:e.currentId,callback:function(t){e.currentId=t},expression:"currentId"}},[s("i")])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"host",label:"IP",width:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"port",label:"端口",width:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"clusterId",label:"集群id"}}),e._v(" "),s("el-table-column",{attrs:{prop:"description",label:"描述"}}),e._v(" "),s("el-table-column",{attrs:{label:"操作",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{directives:[{name:"permission",rawName:"v-permission",value:e.permission.info.code,expression:"permission.info.code"}],ref:t.row,attrs:{type:"primary",icom:"el-icon-tickets",size:"mini",plain:""},on:{click:function(s){return e.info(t.row.id)}}},[e._v("info")]),e._v(" "),s("el-button",{directives:[{name:"permission",rawName:"v-permission",value:e.keyPermission.scan.code,expression:"keyPermission.scan.code"}],ref:t.row,attrs:{type:"success",size:"mini",plain:""},on:{click:function(s){return e.manage(t.row)}}},[e._v("数据管理")])]}}])})],1),e._v(" "),s("Info",{attrs:{visible:e.infoDialog.visible,info:e.infoDialog.info},on:{close:function(t){e.infoDialog.visible=!1}}}),e._v(" "),s("dynamic-form-dialog",{attrs:{visible:e.formDialog.visible,title:e.formDialog.title,formInfo:e.formDialog.formInfo,formData:e.formDialog.formData},on:{cancel:e.closeDialog,submitSuccess:e.submitSuccess}})],1)}),[],!1,null,null,null);t.default=v.exports}}]);