(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{168:function(e,t,s){"use strict";var r,n=s(19),a=s.n(n),i=s(36),o=s(184),l=s.n(o),c=s(10),u=s(1);!function(e){e[e.SUCCESS=200]="SUCCESS",e[e.ERROR=400]="ERROR",e[e.PARAM_ERROR=405]="PARAM_ERROR",e[e.SERVER_ERROR=500]="SERVER_ERROR",e[e.NO_PERMISSION=501]="NO_PERMISSION"}(r||(r={}));const d=u.a.apiUrl;function p(e){a.a.Message.error(e)}const m=l.a.create({baseURL:d,timeout:5e3});function h(e,t){return e.replace(/\{\w+\}/g,e=>{let s=e.substring(1,e.length-1),r=t[s];return null!=r||null!=r?r:""})}function g(e,t,s){if(!t)throw new Error("请求url不能为空");-1!=t.indexOf("{")&&(t=h(t,s));const r={method:e,url:t},n=e.toLowerCase();return"post"===n||"put"===n?r.data=s:r.params=s,m.request(r).then(e=>e).catch(e=>(p(e.msg||e.message),Promise.reject(e)))}m.interceptors.request.use(e=>{const t=c.a.getToken();return t&&(e.headers.token=t),e},e=>(console.log(e),Promise.reject(e))),m.interceptors.response.use(e=>{const t=e.data;return t.code===r.NO_PERMISSION?(c.a.removeToken(),p("登录超时"),void setTimeout(()=>{i.a.push({path:"/login"})},1e3)):t.code===r.SUCCESS?t.data:Promise.reject(t)},e=>Promise.reject(e)),t.a={request:g,send:function(e,t){return g(e.method,e.url,t)},parseRestUrl:h,getApiUrl:function(e){return d+"?token="+c.a.getToken()}}},171:function(e,t,s){"use strict";var r=s(168);class n{constructor(e,t){this.url=e,this.method=t}setUrl(e){return this.url=e,this}setMethod(e){return this.method=e,this}getUrl(){return r.a.getApiUrl(this.url)}request(e){return r.a.send(this,e)}static create(e,t){return new n(e,t)}}t.a=n},175:function(e,t,s){"use strict";s.d(t,"c",(function(){return n})),s.d(t,"d",(function(){return a})),s.d(t,"a",(function(){return i})),s.d(t,"b",(function(){return o}));var r=s(171);const n={list:r.a.create("/sys/resources","get"),detail:r.a.create("/sys/resources/{id}","get"),save:r.a.create("/sys/resources","post"),update:r.a.create("/sys/resources/{id}","put"),del:r.a.create("/sys/resources/{id}","delete"),changeStatus:r.a.create("/sys/resources/{id}/{status}","put")},a={list:r.a.create("/sys/roles","get"),save:r.a.create("/sys/roles","post"),update:r.a.create("/sys/roles/{id}","put"),del:r.a.create("/sys/roles/{id}","delete"),roleResourceIds:r.a.create("/sys/roles/{id}/resourceIds","get"),roleResources:r.a.create("/sys/roles/{id}/resources","get"),saveResources:r.a.create("/sys/roles/{id}/resources","post")},i={list:r.a.create("/sys/accounts","get"),save:r.a.create("/sys/accounts","post"),update:r.a.create("/sys/accounts/{id}","put"),del:r.a.create("/sys/accounts/{id}","delete"),changeStatus:r.a.create("/sys/accounts/{id}/{status}","put"),roleIds:r.a.create("/sys/accounts/{id}/roleIds","get"),roles:r.a.create("/sys/accounts/{id}/roles","get"),resources:r.a.create("/sys/accounts/{id}/resources","get"),saveRoles:r.a.create("/sys/accounts/{id}/roles","post")},o={list:r.a.create("/sys/logs","get")}},178:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));class r{add(e,t,s){return this[e]={label:t,value:s},this}getLabelByValue(e){if(null==e)return"";for(let t in this){let s=this[t];if(s&&s.value===e)return s.label}return""}}},183:function(e,t,s){"use strict";var r=s(178);t.a={ResourceTypeEnum:(new r.a).add("MENU","菜单",1).add("PERMISSION","权限",2),accountStatus:(new r.a).add("ENABLE","正常",1).add("DISABLE","禁用",0),logType:(new r.a).add("UPDATE","修改",2).add("DELETE","删除",3).add("SYS_LOG","系统",4).add("ERR_LOG","异常",5)}},231:function(e,t,s){"use strict";s.d(t,"b",(function(){return n})),s.d(t,"c",(function(){return a})),s.d(t,"a",(function(){return i}));var r=s(10);const n={resource:r.a.code("resource"),save:r.a.code("resource:save"),update:r.a.code("resource:update"),del:r.a.code("resource:delete")},a={role:r.a.code("role"),del:r.a.code("role:delete"),saveResources:r.a.code("role:saveResources")},i={account:r.a.code("account"),changeStatus:r.a.code("account:changeStatus"),del:r.a.code("account:delete"),saveRoles:r.a.code("account:saveRoles")}},297:function(e,t,s){var r=s(34),n=s(728);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var a={insert:"head",singleton:!1};r(n,a);e.exports=n.locals||{}},298:function(e,t,s){var r=s(34),n=s(730);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var a={insert:"head",singleton:!1};r(n,a);e.exports=n.locals||{}},727:function(e,t,s){"use strict";var r=s(297);s.n(r).a},728:function(e,t,s){(t=s(35)(!1)).push([e.i,"",""]),e.exports=t},729:function(e,t,s){"use strict";var r=s(298);s.n(r).a},730:function(e,t,s){(t=s(35)(!1)).push([e.i,".menu .el-tree-node__content {\n  height: 40px;\n  line-height: 40px;\n}\n.none-select {\n  moz-user-select: -moz-none;\n  -moz-user-select: none;\n  -o-user-select: none;\n  -khtml-user-select: none;\n  -webkit-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n}\n",""]),e.exports=t},742:function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return p}));var r=s(61),n=s(33),a=s(175),i=s(183);var o=(()=>{let e=class extends n.c{constructor(){super(...arguments),this.enums=i.a,this.dialogForm={title:"",visible:!1,data:{}},this.props={value:"id",label:"name",children:"children"},this.form={id:null,name:null,pid:null,code:null,url:null,icon:null,type:null,weight:null},this.btnLoading=!1,this.rules={name:[{required:!0,message:"请输入资源名称",trigger:["change","blur"]}],weight:[{required:!0,message:"请输入序号",trigger:["change","blur"]}]}}onDataChange(){this.data&&this.$Utils.copyProperties(this.data,this.form)}btnOk(){let e=this.form.id?a.c.update:a.c.save;this.$refs.menuForm.validate(t=>{if(!t)return!1;e.request(this.form).then(e=>{this.$emit("val-change",this.form),this.btnLoading=!0,this.$message.success("保存成功"),setTimeout(()=>{this.btnLoading=!1},1e3),this.cancel()})})}cancel(){this.$emit("update:visible",!1),this.$emit("cancel"),setTimeout(()=>{this.$refs.menuForm.resetFields(),this.$Utils.resetProperties(this.form)},200)}};return Object(r.a)([Object(n.b)()],e.prototype,"visible",void 0),Object(r.a)([Object(n.b)()],e.prototype,"data",void 0),Object(r.a)([Object(n.b)()],e.prototype,"title",void 0),Object(r.a)([Object(n.b)()],e.prototype,"type",void 0),Object(r.a)([Object(n.b)()],e.prototype,"typeDisabled",void 0),Object(r.a)([Object(n.d)("data",{deep:!0})],e.prototype,"onDataChange",null),e=Object(r.a)([Object(n.a)({name:"ResourceEdit"})],e),e})(),l=(s(727),s(60)),c=Object(l.a)(o,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"menu-dialog"},[s("el-dialog",{attrs:{title:e.title,visible:e.visible,"show-close":!1,width:"28%"}},[s("el-form",{ref:"menuForm",attrs:{model:e.form,rules:e.rules,"label-width":"85px",size:"small"}},[s("el-form-item",{attrs:{prop:"name",label:"名称",required:""}},[s("el-input",{attrs:{placeholder:"请输入资源名","auto-complete":"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"==typeof t?t.trim():t)},expression:"form.name"}})],1),e._v(" "),s("el-form-item",{attrs:{prop:"type",label:"类型",required:""}},e._l(e.enums.ResourceTypeEnum,(function(t){return s("el-radio",{key:t.value,attrs:{disabled:e.typeDisabled,label:t.value},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[e._v(e._s(t.label))])})),1),e._v(" "),e.form.type===e.enums.ResourceTypeEnum.MENU.value?s("el-form-item",{attrs:{label:"样式"}},[s("el-input",{attrs:{placeholder:"请输入菜单图标样式"},model:{value:e.form.icon,callback:function(t){e.$set(e.form,"icon","string"==typeof t?t.trim():t)},expression:"form.icon"}})],1):e._e(),e._v(" "),e.form.type===e.enums.ResourceTypeEnum.MENU.value?s("el-form-item",{attrs:{prop:"code",label:"路由"}},[s("el-input",{attrs:{placeholder:"请输入路由code"},model:{value:e.form.url,callback:function(t){e.$set(e.form,"url","string"==typeof t?t.trim():t)},expression:"form.url"}})],1):e._e(),e._v(" "),s("el-form-item",{attrs:{prop:"code",label:"权限code"}},[s("el-input",{attrs:{placeholder:"请输入权限code"},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code","string"==typeof t?t.trim():t)},expression:"form.code"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"序号",prop:"weight",required:""}},[s("el-input",{attrs:{type:"number",placeholder:"请输入序号"},model:{value:e.form.weight,callback:function(t){e.$set(e.form,"weight","string"==typeof t?t.trim():t)},expression:"form.weight"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"}},[s("el-button",{attrs:{type:"primary",loading:e.btnLoading,size:"mini"},on:{click:e.btnOk}},[e._v("确 定")]),e._v(" "),s("el-button",{attrs:{size:"mini"},on:{click:function(t){return e.cancel()}}},[e._v("取 消")])],1)],1)],1)}),[],!1,null,null,null).exports,u=s(231);var d=(()=>{let e=class extends n.c{constructor(){super(...arguments),this.enums=i.a,this.permission=u.b,this.showBtns=!1,this.rightClickData={},this.dialogForm={title:"",visible:!1,data:{pid:0,type:1},typeDisabled:!0},this.data=[],this.props={label:"name",children:"children"},this.defaultExpandedKeys=[]}mounted(){this.search()}async search(){let e=await a.c.list.request(null);this.data=e}deleteMenu(e){this.$confirm(`此操作将删除 [${e.name}], 是否继续?`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{a.c.del.request({id:e.id}).then(e=>{this.$message.success("删除成功！"),this.search()})})}addResource(e){let t=this.dialogForm;t.visible=!0,t.data={pid:0,type:1};let s=i.a.ResourceTypeEnum.MENU.value,r=i.a.ResourceTypeEnum.PERMISSION.value;if(!e)return t.typeDisabled=!0,t.data.type=s,void(t.title="添加顶级菜单");if(t.data.pid=e.id,t.title="添加“"+e.name+"”的子资源 ",null===e.children||0===e.children.length)t.typeDisabled=!1;else{t.typeDisabled=!0;let n=!1;for(let t of e.children)if(t.type===r){n=!0;break}t.data.type=n?r:s}}async editResource(e){this.dialogForm.visible=!0,this.dialogForm.data=await a.c.detail.request({id:e.id}),this.dialogForm.typeDisabled=!0,this.dialogForm.title="修改“"+e.name+"”菜单"}valChange(e){this.search(),this.dialogForm.visible=!1}async changeStatus(e,t){await a.c.changeStatus.request({id:e.id,status:t}),e.status=t,this.$message.success((1===t?"启用":"禁用")+"成功！")}handleNodeExpand(e,t){const s=t.data.id;this.defaultExpandedKeys.includes(s)||this.defaultExpandedKeys.push(s)}handleNodeCollapse(e,t){this.removeDeafultExpandId(t.data.id);let s=t.childNodes;for(let t of s){if(2==t.data.type)return;t.expanded&&this.removeDeafultExpandId(t.data.id),this.handleNodeCollapse(e,t)}}removeDeafultExpandId(e){let t=this.defaultExpandedKeys.indexOf(e);t>-1&&this.defaultExpandedKeys.splice(t,1)}async info(e){let t=await a.c.detail.request({id:e.id});t.type!==i.a.ResourceTypeEnum.MENU.value?this.$alert('<strong style="margin-right: 18px">名称:</strong>'+t.name+' <br/><strong style="margin-right: 18px">权限code:</strong>'+(t.code?t.code:"无")+' <br/><strong style="margin-right: 18px">权重:</strong>'+t.weight+' <br/><strong style="margin-right: 18px">创建人:</strong>'+t.creator+' <br/><strong style="margin-right: 18px">创建时间:</strong>'+t.createTime+' <br/><strong style="margin-right: 18px">修改人:</strong>'+t.modifier+' <br/><strong style="margin-right: 18px">修改时间:</strong>'+t.updateTime,"权限详情",{type:"info",dangerouslyUseHTMLString:!0,closeOnClickModal:!0,showConfirmButton:!1}).catch(e=>{}):this.$alert('<strong style="margin-right: 18px">名称:</strong>'+t.name+' <br/><strong style="margin-right: 18px">图标:</strong>'+(t.icon?t.icon:"无")+' <br/><strong style="margin-right: 18px">路由:</strong>'+(t.url?t.url:"无")+' <br/><strong style="margin-right: 18px">权限code:</strong>'+(t.code?t.code:"无")+' <br/><strong style="margin-right: 18px">权重:</strong>'+t.weight+' <br/><strong style="margin-right: 18px">创建人:</strong>'+t.creator+' <br/><strong style="margin-right: 18px">创建时间:</strong>'+t.createTime+' <br/><strong style="margin-right: 18px">修改人:</strong>'+t.modifier+' <br/><strong style="margin-right: 18px">修改时间:</strong>'+t.updateTime,"菜单详情",{type:"info",dangerouslyUseHTMLString:!0,closeOnClickModal:!0,showConfirmButton:!1}).catch(e=>{})}};return e=Object(r.a)([Object(n.a)({name:"ResourceList",components:{ResourceEdit:c}})],e),e})(),p=(s(729),Object(l.a)(d,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"menu"},[s("div",{staticClass:"toolbar"},[e._m(0),e._v(" "),s("el-button",{directives:[{name:"permission",rawName:"v-permission",value:e.permission.save.code,expression:"permission.save.code"}],attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:function(t){return e.addResource(!1)}}},[e._v("添加")])],1),e._v(" "),s("el-tree",{staticClass:"none-select",attrs:{indent:38,"node-key":"id",props:e.props,data:e.data,"default-expanded-keys":e.defaultExpandedKeys,"expand-on-click-node":!1},on:{"node-expand":e.handleNodeExpand,"node-collapse":e.handleNodeCollapse},scopedSlots:e._u([{key:"default",fn:function(t){t.node;var r=t.data;return s("span",{staticClass:"custom-tree-node"},[r.type===e.enums.ResourceTypeEnum.MENU.value?s("span",{staticStyle:{"font-size":"13px"}},[s("span",{staticStyle:{color:"#3c8dbc"}},[e._v("【")]),e._v("\n        "+e._s(r.name)+"\n        "),s("span",{staticStyle:{color:"#3c8dbc"}},[e._v("】")]),e._v(" "),null!==r.children?s("el-tag",{attrs:{size:"mini"}},[e._v(e._s(r.children.length))]):e._e()],1):e._e(),e._v(" "),r.type===e.enums.ResourceTypeEnum.PERMISSION.value?s("span",{staticStyle:{"font-size":"13px"}},[s("span",{staticStyle:{color:"#3c8dbc"}},[e._v("【")]),e._v(" "),s("span",{style:1==r.status?"color: #67c23a;":"color: #f67c6c;"},[e._v(e._s(r.name))]),e._v(" "),s("span",{staticStyle:{color:"#3c8dbc"}},[e._v("】")])]):e._e(),e._v(" "),s("el-link",{staticStyle:{"margin-left":"25px"},attrs:{icon:"el-icon-view",type:"info",underline:!1},on:{click:function(t){return e.info(r)}}}),e._v(" "),s("el-link",{directives:[{name:"permission",rawName:"v-permission",value:e.permission.update.code,expression:"permission.update.code"}],attrs:{type:"primary",icon:"el-icon-edit",underline:!1},on:{click:function(t){return e.editResource(r)}}}),e._v(" "),r.type===e.enums.ResourceTypeEnum.MENU.value?s("el-link",{directives:[{name:"permission",rawName:"v-permission",value:e.permission.save.code,expression:"permission.save.code"}],attrs:{icon:"el-icon-circle-plus-outline",underline:!1,type:"success"},on:{click:function(t){return e.addResource(r)}}}):e._e(),e._v(" "),1===r.status&&r.type===e.enums.ResourceTypeEnum.PERMISSION.value?s("el-link",{directives:[{name:"permission",rawName:"v-permission",value:e.permission.resource.code,expression:"permission.resource.code"}],attrs:{icon:"el-icon-circle-close",underline:!1,type:"warning"},on:{click:function(t){return e.changeStatus(r,0)}}}):e._e(),e._v(" "),0===r.status&&r.type===e.enums.ResourceTypeEnum.PERMISSION.value?s("el-link",{directives:[{name:"permission",rawName:"v-permission",value:e.permission.resource.code,expression:"permission.resource.code"}],attrs:{type:"success",icon:"el-icon-circle-check",underline:!1,plain:""},on:{click:function(t){return e.changeStatus(r,1)}}}):e._e(),e._v(" "),null==r.children?s("el-link",{directives:[{name:"permission",rawName:"v-permission",value:e.permission.del.code,expression:"permission.del.code"}],attrs:{type:"danger",icon:"el-icon-remove-outline",underline:!1,plain:""},on:{click:function(t){return e.deleteMenu(r)}}}):e._e()],1)}}])}),e._v(" "),s("ResourceEdit",{attrs:{title:e.dialogForm.title,visible:e.dialogForm.visible,data:e.dialogForm.data,typeDisabled:e.dialogForm.typeDisabled,departTree:e.data,type:e.dialogForm.type},on:{"update:visible":function(t){return e.$set(e.dialogForm,"visible",t)},"update:data":function(t){return e.$set(e.dialogForm,"data",t)},"val-change":e.valChange}})],1)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("span",{staticStyle:{"font-size":"14px"}},[t("i",{staticClass:"el-icon-info"}),this._v("红色字体表示禁用状态\n      ")])])}],!1,null,null,null).exports)}}]);