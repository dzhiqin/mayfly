(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{161:function(e,t,s){var o=s(36),a=s(175);"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var n={insert:"head",singleton:!1};o(a,n);e.exports=a.locals||{}},171:function(e,t,s){"use strict";s(174);var o=s(61),a=Object(o.a)({},(function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"toolbar"},[this._t("default")],2)}),[],!1,null,null,null);t.a=a.exports},174:function(e,t,s){"use strict";var o=s(161);s.n(o).a},175:function(e,t,s){(t=s(37)(!1)).push([e.i,"\n.toolbar {\n  width: 100%;\n  padding: 8px;\n  background-color: #ffffff;\n  overflow: hidden;\n  line-height: 32px;\n  border: 1px solid #e6ebf5;\n}\n",""]),e.exports=t},176:function(e,t,s){"use strict";var o=s(6),a=s.n(o),n=s(11),r=s.n(n),i=s(182),l=function(){function e(t){a()(this,e),this.url=t}return r()(e,[{key:"url",value:function(e){return this.url=e,this}},{key:"method",value:function(e){return this.method=e,this}},{key:"getUrl",value:function(){return i.a.getApiUrl(this.url)}},{key:"request",value:function(e){return i.a.send(this,e)}}],[{key:"url",value:function(t){return new e(t)}}]),e}();t.a=l},181:function(e,t,s){"use strict";s.d(t,"c",(function(){return a})),s.d(t,"d",(function(){return n})),s.d(t,"a",(function(){return r})),s.d(t,"b",(function(){return i}));var o=s(176),a={list:o.a.url("/sys/resources").method("get"),detail:o.a.url("/sys/resources/{id}").method("get"),save:o.a.url("/sys/resources").method("post"),update:o.a.url("/sys/resources/{id}").method("put"),del:o.a.url("/sys/resources/{id}").method("delete"),changeStatus:o.a.url("/sys/resources/{id}/{status}").method("put")},n={list:o.a.url("/sys/roles").method("get"),save:o.a.url("/sys/roles").method("post"),update:o.a.url("/sys/roles/{id}").method("put"),del:o.a.url("/sys/roles/{id}").method("delete"),roleResourceIds:o.a.url("/sys/roles/{id}/resourceIds").method("get"),roleResources:o.a.url("/sys/roles/{id}/resources").method("get"),saveResources:o.a.url("/sys/roles/{id}/resources").method("post")},r={list:o.a.url("/sys/accounts").method("get"),save:o.a.url("/sys/accounts").method("post"),del:o.a.url("/sys/accounts/{id}").method("delete"),changeStatus:o.a.url("/sys/accounts/{id}/{status}").method("put"),roleIds:o.a.url("/sys/accounts/{id}/roleIds").method("get"),roles:o.a.url("/sys/accounts/{id}/roles").method("get"),resources:o.a.url("/sys/accounts/{id}/resources").method("get"),saveRoles:o.a.url("/sys/accounts/{id}/roles").method("post")},i={list:o.a.url("/sys/logs").method("get")}},189:function(e,t,s){"use strict";var o=s(190);t.a={ResourceTypeEnum:(new o.a).add("MENU","菜单",1).add("PERMISSION","权限",2),accountStatus:(new o.a).add("ENABLE","正常",1).add("DISABLE","禁用",0),logType:(new o.a).add("UPDATE","修改",2).add("DELETE","删除",3).add("SYS_LOG","系统",4).add("ERR_LOG","异常",5)}},237:function(e,t,s){"use strict";s.d(t,"b",(function(){return a})),s.d(t,"c",(function(){return n})),s.d(t,"a",(function(){return r}));var o=s(12),a={resource:o.a.code("resource"),save:o.a.code("resource:save"),update:o.a.code("resource:update"),del:o.a.code("resource:delete")},n={role:o.a.code("role"),del:o.a.code("role:delete"),saveResources:o.a.code("role:saveResources")},r={account:o.a.code("account"),changeStatus:o.a.code("account:changeStatus"),del:o.a.code("account:delete"),saveRoles:o.a.code("account:saveRoles")}},238:function(e,t,s){"use strict";var o={name:"HelpHint",props:{placement:{default:"top"},content:String},data:function(){return{}}},a=s(61),n=Object(a.a)(o,(function(){var e=this.$createElement,t=this._self._c||e;return t("span",[t("span",{staticStyle:{"margin-right":"8px"}},[this._t("default")],2),this._v(" "),t("el-tooltip",{attrs:{content:this.content,placement:this.placement}},[t("i",{staticClass:"el-icon-question",staticStyle:{cursor:"pointer"}})])],1)}),[],!1,null,null,null);t.a=n.exports},753:function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return b}));var o=s(172),a=s.n(o),n=s(173),r=s.n(n),i=s(171),l=s(238),c=s(237),u=(s(34),s(181)),d={name:"RoleEdit",props:{visible:!1,account:[Object,Boolean]},data:function(){return{btnLoading:!1,allRole:[],roles:[],query:{name:null,pageNum:1,pageSize:5},total:0}},watch:{account:{handler:function(){var e=this;this.account&&u.a.roleIds.request({id:this.account.id}).then((function(t){e.roles=t,e.search()}))},deep:!0}},methods:{handlePageChange:function(e){this.search()},select:function(e,t){var s=this.roles;if(s.includes(t.id))for(var o=0;o<s.length;o++){if(s[o]===t.id){s.splice(o,1);break}}else s.push(t.id)},checkSelected:function(){var e=this;setTimeout((function(){e.$refs.roleTable.clearSelection(),e.allRole.forEach((function(t){e.roles.includes(t.id)&&e.$refs.roleTable.toggleRowSelection(t,!0)}))}),50)},btnOk:function(){var e=this;return r()(a.a.mark((function t(){var s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=e.roles.join(","),t.next=3,u.a.saveRoles.request({id:e.account.id,roleIds:s});case 3:e.$message.success("保存成功!"),e.cancel();case 5:case"end":return t.stop()}}),t)})))()},cancel:function(){this.query.pageNum=1,this.query.code=null,this.$emit("cancel")},clear:function(){this.query.pageNum=1,this.query.name=null,this.search()},search:function(){var e=this;return r()(a.a.mark((function t(){var s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.d.list.request(e.query);case 2:s=t.sent,e.allRole=s.list,e.total=s.total,e.checkSelected();case 6:case"end":return t.stop()}}),t)})))()}},mounted:function(){},components:{ToolBar:i.a}},p=s(61),m=Object(p.a)(d,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"account-dialog"},[s("el-dialog",{attrs:{title:"分配“"+e.account.username+"”的角色",visible:e.visible,"show-close":!1}},[s("ToolBar",[s("div",{staticStyle:{float:"left"}},[s("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"请输入角色名",size:"small",clearable:""},on:{clear:function(t){return e.clear()}},model:{value:e.query.name,callback:function(t){e.$set(e.query,"name",t)},expression:"query.name"}}),e._v(" "),s("el-button",{attrs:{type:"success",icon:"el-icon-search",size:"small"},on:{click:e.search}})],1)]),e._v(" "),s("el-table",{ref:"roleTable",staticStyle:{width:"100%"},attrs:{data:e.allRole,border:""},on:{select:e.select}},[s("el-table-column",{attrs:{type:"selection",width:"40"}}),e._v(" "),s("el-table-column",{attrs:{prop:"name",label:"角色名称"}}),e._v(" "),s("el-table-column",{attrs:{prop:"remark",label:"角色描述"},scopedSlots:e._u([{key:"default",fn:function(t){return s("div",{},[e._v("\n          "+e._s(t.row.remark?t.row.remark:"暂无描述")+"\n        ")])}}])})],1),e._v(" "),s("el-pagination",{staticStyle:{"text-align":"center","margin-top":"20px"},attrs:{background:"",layout:"prev, pager, next, total, jumper",total:e.total,"current-page":e.query.pageNum,"page-size":e.query.pageSize},on:{"current-change":e.handlePageChange,"update:currentPage":function(t){return e.$set(e.query,"pageNum",t)},"update:current-page":function(t){return e.$set(e.query,"pageNum",t)}}}),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:function(t){return e.cancel()}}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary",loading:e.btnLoading,size:"small"},on:{click:e.btnOk}},[e._v("确 定")])],1)],1)],1)}),[],!1,null,null,null).exports,h=s(189),f={name:"AccountEdit",props:{visible:Boolean,account:[Object,Boolean],title:String},data:function(){return{enums:h.a,edit:!1,form:{id:null,username:null,password:null,repassword:null},btnLoading:!1,rules:{username:[{required:!0,message:"请输入用户名",trigger:["change","blur"]}],password:[{required:!0,message:"请输入密码",trigger:["change","blur"]}]}}},watch:{account:{handler:function(){this.account?(this.edit=!0,this.$Utils.copyProperties(this.account,this.form)):this.edit=!1},deep:!0}},methods:{btnOk:function(){var e=this;return r()(a.a.mark((function t(){var s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s=e.form.id?u.a.update:u.a.save,e.$refs.accountForm.validate((function(t){if(!t)return e.$message.error("表单填写有误"),!1;s.request(e.form).then((function(t){e.$message.success("操作成功"),e.$emit("val-change",e.form),e.btnLoading=!0,setTimeout((function(){e.btnLoading=!1}),1e3),e.$refs.accountForm.resetFields(),e.$Utils.resetProperties(e.form)}))}));case 2:case"end":return t.stop()}}),t)})))()},cancel:function(){var e=this;this.$emit("cancel"),setTimeout((function(){e.$refs.accountForm.resetFields(),e.$Utils.resetProperties(e.form)}),200)}},mounted:function(){},components:{}},v=Object(p.a)(f,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"account-dialog"},[s("el-dialog",{attrs:{title:e.title,visible:e.visible,"show-close":!1,width:"35%"}},[s("el-form",{ref:"accountForm",attrs:{model:e.form,rules:e.rules,"label-width":"85px",size:"small"}},[s("el-form-item",{attrs:{prop:"username",label:"用户名:",required:""}},[s("el-input",{attrs:{disabled:e.edit,placeholder:"请输入用户名","auto-complete":"off"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username","string"==typeof t?t.trim():t)},expression:"form.username"}})],1),e._v(" "),s("el-form-item",{attrs:{prop:"password",label:"密码:",required:""}},[s("el-input",{attrs:{type:"password",placeholder:"请输入密码",autocomplete:"new-password"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password","string"==typeof t?t.trim():t)},expression:"form.password"}})],1),e._v(" "),e.edit?e._e():s("el-form-item",{attrs:{label:"确认密码:",required:""}},[s("el-input",{attrs:{type:"password",placeholder:"请输入确认密码",autocomplete:"new-password"},model:{value:e.form.repassword,callback:function(t){e.$set(e.form,"repassword","string"==typeof t?t.trim():t)},expression:"form.repassword"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"mini"},on:{click:e.cancel}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary",loading:e.btnLoading,size:"small"},on:{click:e.btnOk}},[e._v("确 定")])],1)],1)],1)}),[],!1,null,null,null).exports,g={data:function(){return{enums:h.a,permission:c.a,chooseId:null,chooseData:null,query:{pageNum:1,pageSize:10},datas:[],total:null,showRoleDialog:{title:"",visible:!1,accountRoles:[]},showResourceDialog:{title:"",visible:!1,resources:[],defaultProps:{children:"children",label:"name"}},roleDialog:{visible:!1,account:{},roles:[]},accountDialog:{visible:!1,data:!1}}},methods:{choose:function(e){e&&(this.chooseId=e.id,this.chooseData=e)},search:function(){var e=this;return r()(a.a.mark((function t(){var s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.a.list.request(e.query);case 2:s=t.sent,e.datas=s.list,e.total=s.total;case 5:case"end":return t.stop()}}),t)})))()},showResources:function(e){var t=this;return r()(a.a.mark((function s(){var o;return a.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return(o=t.showResourceDialog).title='"'+e.username+'" 的菜单&权限',o.resources=[],s.next=5,u.a.resources.request({id:e.id});case 5:o.resources=s.sent,o.visible=!0;case 7:case"end":return s.stop()}}),s)})))()},showRoles:function(e){var t=this;return r()(a.a.mark((function s(){var o;return a.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return(o=t.showRoleDialog).title='"'+e.username+'" 的角色信息',s.next=4,u.a.roles.request({id:e.id});case 4:o.accountRoles=s.sent,o.visible=!0;case 6:case"end":return s.stop()}}),s)})))()},changeStatus:function(e){var t=this;return r()(a.a.mark((function s(){var o,n;return a.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return o=e.id,n=e.status?1:0,s.next=4,u.a.changeStatus.request({id:o,status:n});case 4:t.$message.success("操作成功"),t.search();case 6:case"end":return s.stop()}}),s)})))()},handlePageChange:function(e){this.query.pageNum=e,this.search()},roleEdit:function(){this.chooseId||this.$message.error("请选择账号"),this.roleDialog.visible=!0,console.log(this.chooseData),this.roleDialog.account=this.chooseData},editAccount:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.accountDialog.data=!e&&this.chooseData,this.accountDialog.visible=!0},cancel:function(){this.roleDialog.visible=!1,this.roleDialog.account=!1,this.search()},accountDialogCancel:function(){var e=this;this.accountDialog.visible=!1,setTimeout((function(){e.accountDialog.data=!1}),800)},valChange:function(){this.accountDialog.visible=!1,this.search()},deleteAccount:function(){var e=this;u.a.del.request({id:this.chooseId}).then((function(t){e.$message.success("删除成功"),e.search()}))}},mounted:function(){this.search()},components:{ToolBar:i.a,HelpHint:l.a,RoleEdit:m,AccountEdit:v}},b=Object(p.a)(g,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"role-list"},[s("ToolBar",[s("el-button",{directives:[{name:"permission",rawName:"v-permission",value:e.permission.account.code,expression:"permission.account.code"}],attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:function(t){return e.editAccount(!0)}}},[e._v("添加")]),e._v(" "),s("el-button",{directives:[{name:"permission",rawName:"v-permission",value:e.permission.account.code,expression:"permission.account.code"}],attrs:{disabled:null==e.chooseId,type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(t){return e.editAccount(!1)}}},[e._v("编辑")]),e._v(" "),s("el-button",{directives:[{name:"permission",rawName:"v-permission",value:e.permission.saveRoles.code,expression:"permission.saveRoles.code"}],attrs:{disabled:null==e.chooseId,type:"success",icon:"el-icon-setting",size:"mini"},on:{click:function(t){return e.roleEdit()}}},[e._v("角色分配")]),e._v(" "),s("el-button",{directives:[{name:"permission",rawName:"v-permission",value:e.permission.del.code,expression:"permission.del.code"}],attrs:{disabled:null==e.chooseId,type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(t){return e.deleteAccount()}}},[e._v("删除")]),e._v(" "),s("div",{staticStyle:{float:"right"}},[s("el-input",{staticStyle:{width:"140px"},attrs:{placeholder:"请输入账号名",size:"small",clearable:""},on:{clear:function(t){return e.search()}},model:{value:e.query.username,callback:function(t){e.$set(e.query,"username",t)},expression:"query.username"}}),e._v(" "),s("el-button",{attrs:{type:"success",icon:"el-icon-search",size:"mini"},on:{click:function(t){return e.search()}}})],1)],1),e._v(" "),s("el-table",{ref:"table",attrs:{data:e.datas,border:"","show-overflow-tooltip":""},on:{"current-change":e.choose}},[s("el-table-column",{attrs:{label:"选择",width:"50px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-radio",{attrs:{label:t.row.id},model:{value:e.chooseId,callback:function(t){e.chooseId=t},expression:"chooseId"}},[s("i")])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"username",label:"用户名","min-width":"115"}}),e._v(" "),s("el-table-column",{attrs:{align:"center",prop:"status",label:"状态","min-width":"63"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{attrs:{content:1==t.row.status?"启用":"禁用",placement:"top"}},[s("el-switch",{attrs:{"active-value":1,"active-color":"#13ce66","inactive-color":"#ff4949",disabled:!e.$Permission.getPermission(e.permission.changeStatus.code).show||e.$Permission.getPermission(e.permission.changeStatus.code).disabled},on:{change:function(s){return e.changeStatus(t.row)}},model:{value:t.row.status,callback:function(s){e.$set(t.row,"status",s)},expression:"scope.row.status"}})],1)]}}])}),e._v(" "),s("el-table-column",{attrs:{"min-width":"115",prop:"createAccount",label:"创建账号"}}),e._v(" "),s("el-table-column",{attrs:{"min-width":"160",prop:"createTime",label:"创建时间"}}),e._v(" "),s("el-table-column",{attrs:{"min-width":"115",prop:"updateAccount",label:"更新账号"}}),e._v(" "),s("el-table-column",{attrs:{"min-width":"160",prop:"updateTime",label:"修改时间"}}),e._v(" "),s("el-table-column",{attrs:{label:"查看更多","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-link",{directives:[{name:"permission",rawName:"v-permission",value:e.permission.account.code,expression:"permission.account.code"}],attrs:{type:"success"},on:{click:function(s){return e.showRoles(t.row)}}},[e._v("角色")]),e._v(" "),s("el-link",{directives:[{name:"permission",rawName:"v-permission",value:e.permission.account.code,expression:"permission.account.code"}],attrs:{type:"info"},on:{click:function(s){return e.showResources(t.row)}}},[e._v("菜单&权限")])]}}])}),e._v(" "),s("el-table-column",{attrs:{"min-width":"120",prop:"remark",label:"备注","show-overflow-tooltip":""}})],1),e._v(" "),s("el-pagination",{staticStyle:{"text-align":"center"},attrs:{background:"",layout:"prev, pager, next, total, jumper",total:e.total,"current-page":e.query.pageNum,"page-size":e.query.pageSize},on:{"current-change":e.handlePageChange,"update:currentPage":function(t){return e.$set(e.query,"pageNum",t)},"update:current-page":function(t){return e.$set(e.query,"pageNum",t)}}}),e._v(" "),s("el-dialog",{attrs:{width:"500px",title:e.showRoleDialog.title,visible:e.showRoleDialog.visible},on:{"update:visible":function(t){return e.$set(e.showRoleDialog,"visible",t)}}},[s("el-table",{attrs:{border:"",data:e.showRoleDialog.accountRoles}},[s("el-table-column",{attrs:{property:"name",label:"角色名",width:"125"}}),e._v(" "),s("el-table-column",{attrs:{property:"createAccount",label:"分配账号",width:"125"}}),e._v(" "),s("el-table-column",{attrs:{property:"createTime",label:"分配时间"}})],1)],1),e._v(" "),s("el-dialog",{attrs:{title:e.showResourceDialog.title,visible:e.showResourceDialog.visible,width:"400px",height:"400px"},on:{"update:visible":function(t){return e.$set(e.showResourceDialog,"visible",t)}}},[s("el-tree",{staticStyle:{height:"50vh",overflow:"auto"},attrs:{data:e.showResourceDialog.resources,"node-key":"id",props:e.showResourceDialog.defaultProps,"expand-on-click-node":!1},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.node,a=t.data;return s("span",{staticClass:"custom-tree-node"},[a.type==e.enums.ResourceTypeEnum.MENU.value?s("span",[e._v(e._s(o.label))]):e._e(),e._v(" "),a.type==e.enums.ResourceTypeEnum.PERMISSION.value?s("span",{staticStyle:{color:"#67c23a"}},[e._v(e._s(o.label))]):e._e()])}}])})],1),e._v(" "),s("RoleEdit",{attrs:{visible:e.roleDialog.visible,account:e.roleDialog.account},on:{cancel:function(t){return e.cancel()}}}),e._v(" "),s("AccountEdit",{attrs:{visible:e.accountDialog.visible,account:e.accountDialog.data},on:{cancel:function(t){return e.accountDialogCancel()},"val-change":function(t){return e.valChange()}}})],1)}),[],!1,null,null,null).exports}}]);