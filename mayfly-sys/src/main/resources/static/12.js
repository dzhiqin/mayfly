(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{168:function(e,t,n){"use strict";var o,r=n(19),i=n.n(r),a=n(36),s=n(184),l=n.n(s),c=n(10),u=n(1);!function(e){e[e.SUCCESS=200]="SUCCESS",e[e.ERROR=400]="ERROR",e[e.PARAM_ERROR=405]="PARAM_ERROR",e[e.SERVER_ERROR=500]="SERVER_ERROR",e[e.NO_PERMISSION=501]="NO_PERMISSION"}(o||(o={}));const m=u.a.apiUrl;function g(e){i.a.Message.error(e)}const p=l.a.create({baseURL:m,timeout:5e3});function h(e,t){return e.replace(/\{\w+\}/g,e=>{let n=e.substring(1,e.length-1),o=t[n];return null!=o||null!=o?o:""})}function d(e,t,n){if(!t)throw new Error("请求url不能为空");-1!=t.indexOf("{")&&(t=h(t,n));const o={method:e,url:t},r=e.toLowerCase();return"post"===r||"put"===r?o.data=n:o.params=n,p.request(o).then(e=>e).catch(e=>(g(e.msg||e.message),Promise.reject(e)))}p.interceptors.request.use(e=>{const t=c.a.getToken();return t&&(e.headers.token=t),e},e=>(console.log(e),Promise.reject(e))),p.interceptors.response.use(e=>{const t=e.data;return t.code===o.NO_PERMISSION?(c.a.removeToken(),g("登录超时"),void setTimeout(()=>{a.a.push({path:"/login"})},1e3)):t.code===o.SUCCESS?t.data:Promise.reject(t)},e=>Promise.reject(e)),t.a={request:d,send:function(e,t){return d(e.method,e.url,t)},parseRestUrl:h,getApiUrl:function(e){return m+"?token="+c.a.getToken()}}},252:function(e,t,n){"use strict";var o=n(168);t.a={login:e=>o.a.request("POST","/open/login",e),captcha:()=>o.a.request("GET","/open/captcha",null),logout:e=>o.a.request("POST","/sys/accounts/logout/{token}",e)}},302:function(e,t,n){var o=n(34),r=n(737);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};o(r,i);e.exports=r.locals||{}},735:function(e,t,n){e.exports=n.p+"images/e92f231a1f53d3cc89f925aee2948fab.png"},736:function(e,t,n){"use strict";var o=n(302);n.n(o).a},737:function(e,t,n){(t=n(35)(!1)).push([e.i,".login {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  position: absolute;\n  height: 100%;\n  width: 100%;\n  background-color: #e4e5e6;\n}\n.login .login-form {\n  width: 375px;\n  height: 435px;\n  padding: 30px;\n  background-color: white;\n  text-align: left;\n  border-radius: 4px;\n  position: relative;\n  margin-left: 0;\n  margin-right: 0;\n  zoom: 1;\n  display: block;\n}\n.login .login-form .login-header {\n  text-align: center;\n  font-size: 16px;\n  font-weight: bold;\n  margin-bottom: 20px;\n}\n",""]),e.exports=t},747:function(e,t,n){"use strict";n.r(t);var o=[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"login-header"},[t("img",{attrs:{src:n(735),width:"150",height:"120",alt:""}})])}],r=n(61),i=n(252),a=n(33);var s=(()=>{let e=class extends a.c{constructor(){super(...arguments),this.captchaImage="",this.loginForm={username:"",password:"",captcha:"",uuid:""},this.remember=!1,this.loginLoading=!1}mounted(){this.getCaptcha();let e,t=this.getRemember();null!=t&&(e=JSON.parse(t)),e?(this.remember=!0,this.loginForm.username=e.username,this.loginForm.password=e.password):this.remember=!1}async getCaptcha(){let e=await i.a.captcha();this.captchaImage=e.base64Img,this.loginForm.uuid=e.uuid}async login(){this.loginLoading=!0;try{let e=await i.a.login(this.loginForm);this.remember?localStorage.setItem("remember",JSON.stringify(this.loginForm)):localStorage.removeItem("remember"),setTimeout(()=>{this.$Permission.savePermission(e),this.$notify({title:"登录成功",message:"很高兴你使用Mayfly Admin！别忘了给个Star哦。",type:"success"}),this.loginLoading=!1;let t=this.$route.query.redirect;t?this.$router.push(t):this.$router.push({path:"/"})},500)}catch(e){this.loginLoading=!1,this.loginForm.captcha="",this.getCaptcha()}}getRemember(){return localStorage.getItem("remember")}};return e=Object(r.a)([Object(a.a)({name:"Login"})],e),e})(),l=(n(736),n(60)),c=Object(l.a)(s,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"login"},[n("div",{staticClass:"login-form"},[e._m(0),e._v(" "),n("el-input",{staticStyle:{"margin-bottom":"18px"},attrs:{placeholder:"请输入用户名","suffix-icon":"fa fa-user"},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}}),e._v(" "),n("el-input",{staticStyle:{"margin-bottom":"18px"},attrs:{placeholder:"请输入密码","suffix-icon":"fa fa-keyboard-o",type:"password",autocomplete:"new-password"},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}}),e._v(" "),n("el-row",[n("el-col",{attrs:{span:12}},[n("img",{staticStyle:{cursor:"pointer"},attrs:{width:"130px",height:"40px",src:e.captchaImage},on:{click:e.getCaptcha}})]),e._v(" "),n("el-col",{attrs:{span:12}},[n("el-input",{staticStyle:{"margin-bottom":"18px"},attrs:{placeholder:"请输入算术结果","suffix-icon":"fa fa-user"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login(t)}},model:{value:e.loginForm.captcha,callback:function(t){e.$set(e.loginForm,"captcha",t)},expression:"loginForm.captcha"}})],1)],1),e._v(" "),n("el-button",{staticStyle:{width:"100%","margin-bottom":"18px"},attrs:{type:"primary",loading:e.loginLoading},nativeOn:{click:function(t){return e.login(t)}}},[e._v("登录")]),e._v(" "),n("div",[n("el-checkbox",{model:{value:e.remember,callback:function(t){e.remember=t},expression:"remember"}},[e._v("记住密码")])],1)],1)])}),o,!1,null,null,null);t.default=c.exports}}]);