(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{161:function(e,t,n){var r=n(36),s=n(175);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);var o={insert:"head",singleton:!1};r(s,o);e.exports=s.locals||{}},171:function(e,t,n){"use strict";n(174);var r=n(61),s=Object(r.a)({},(function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"toolbar"},[this._t("default")],2)}),[],!1,null,null,null);t.a=s.exports},174:function(e,t,n){"use strict";var r=n(161);n.n(r).a},175:function(e,t,n){(t=n(37)(!1)).push([e.i,"\n.toolbar {\n  width: 100%;\n  padding: 8px;\n  background-color: #ffffff;\n  overflow: hidden;\n  line-height: 32px;\n  border: 1px solid #e6ebf5;\n}\n",""]),e.exports=t},176:function(e,t,n){"use strict";var r=n(6),s=n.n(r),o=n(11),a=n.n(o),i=n(182),l=function(){function e(t){s()(this,e),this.url=t}return a()(e,[{key:"url",value:function(e){return this.url=e,this}},{key:"method",value:function(e){return this.method=e,this}},{key:"getUrl",value:function(){return i.a.getApiUrl(this.url)}},{key:"request",value:function(e){return i.a.send(this,e)}}],[{key:"url",value:function(t){return new e(t)}}]),e}();t.a=l},181:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));var r=n(176),s={list:r.a.url("/sys/resources").method("get"),detail:r.a.url("/sys/resources/{id}").method("get"),save:r.a.url("/sys/resources").method("post"),update:r.a.url("/sys/resources/{id}").method("put"),del:r.a.url("/sys/resources/{id}").method("delete"),changeStatus:r.a.url("/sys/resources/{id}/{status}").method("put")},o={list:r.a.url("/sys/roles").method("get"),save:r.a.url("/sys/roles").method("post"),update:r.a.url("/sys/roles/{id}").method("put"),del:r.a.url("/sys/roles/{id}").method("delete"),roleResourceIds:r.a.url("/sys/roles/{id}/resourceIds").method("get"),roleResources:r.a.url("/sys/roles/{id}/resources").method("get"),saveResources:r.a.url("/sys/roles/{id}/resources").method("post")},a={list:r.a.url("/sys/accounts").method("get"),save:r.a.url("/sys/accounts").method("post"),del:r.a.url("/sys/accounts/{id}").method("delete"),changeStatus:r.a.url("/sys/accounts/{id}/{status}").method("put"),roleIds:r.a.url("/sys/accounts/{id}/roleIds").method("get"),roles:r.a.url("/sys/accounts/{id}/roles").method("get"),resources:r.a.url("/sys/accounts/{id}/resources").method("get"),saveRoles:r.a.url("/sys/accounts/{id}/roles").method("post")},i={list:r.a.url("/sys/logs").method("get")}},189:function(e,t,n){"use strict";var r=n(190);t.a={ResourceTypeEnum:(new r.a).add("MENU","菜单",1).add("PERMISSION","权限",2),accountStatus:(new r.a).add("ENABLE","正常",1).add("DISABLE","禁用",0),logType:(new r.a).add("UPDATE","修改",2).add("DELETE","删除",3).add("SYS_LOG","系统",4).add("ERR_LOG","异常",5)}},237:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return a}));var r=n(12),s={resource:r.a.code("resource"),save:r.a.code("resource:save"),update:r.a.code("resource:update"),del:r.a.code("resource:delete")},o={role:r.a.code("role"),del:r.a.code("role:delete"),saveResources:r.a.code("role:saveResources")},a={account:r.a.code("account"),changeStatus:r.a.code("account:changeStatus"),del:r.a.code("account:delete"),saveRoles:r.a.code("account:saveRoles")}},304:function(e,t,n){var r=n(36),s=n(739);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);var o={insert:"head",singleton:!1};r(s,o);e.exports=s.locals||{}},305:function(e,t,n){var r=n(36),s=n(741);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);var o={insert:"head",singleton:!1};r(s,o);e.exports=s.locals||{}},738:function(e,t,n){"use strict";var r=n(304);n.n(r).a},739:function(e,t,n){(t=n(37)(!1)).push([e.i,"",""]),e.exports=t},740:function(e,t,n){"use strict";var r=n(305);n.n(r).a},741:function(e,t,n){(t=n(37)(!1)).push([e.i,".menu .el-tree-node__content {\n  height: 40px;\n  line-height: 40px;\n}\n.none-select {\n  moz-user-select: -moz-none;\n  -moz-user-select: none;\n  -o-user-select: none;\n  -khtml-user-select: none;\n  -webkit-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n}\n",""]),e.exports=t},755:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return v}));var r=n(172),s=n.n(r),o=n(173),a=n.n(o),i=n(171),l=n(181),c=n(189),u={name:"ResourceEdit",props:{dialogFormVisible:Boolean,data:[Object,Boolean],title:String,type:Number,typeDisabled:Boolean},data:function(){return{enums:c.a,dialogForm:{title:"",visible:!1,data:{}},props:{value:"id",label:"name",children:"children"},form:{id:null,name:null,pid:null,code:null,url:null,icon:null,type:null,weight:null},btnLoading:!1,rules:{name:[{required:!0,message:"请输入资源名称",trigger:["change","blur"]}],weight:[{required:!0,message:"请输入序号",trigger:["change","blur"]}]}}},watch:{data:{handler:function(){this.data&&this.$Utils.copyProperties(this.data,this.form)},deep:!0}},methods:{handleChange:function(){},addOperation:function(){this.dialogForm.visible=!0},operationChange:function(e){this.operations.push(e),this.dialogForm.visible=!1},btnOk:function(){var e=this,t=this.form.id?l.c.update:l.c.save;this.$refs.menuForm.validate((function(n){if(!n)return!1;t.request(e.form).then((function(t){e.$emit("val-change",e.form),e.btnLoading=!0,e.$message.success("保存成功"),setTimeout((function(){e.btnLoading=!1}),1e3),e.cancel()}))}))},cancel:function(){var e=this;this.$emit("cancel"),setTimeout((function(){e.$refs.menuForm.resetFields(),e.$Utils.resetProperties(e.form)}),200)}},mounted:function(){},components:{}},d=(n(738),n(61)),p=Object(d.a)(u,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"menu-dialog"},[n("el-dialog",{attrs:{title:e.title,visible:e.dialogFormVisible,"show-close":!1,width:"28%"}},[n("el-form",{ref:"menuForm",attrs:{model:e.form,rules:e.rules,"label-width":"85px",size:"small"}},[n("el-form-item",{attrs:{prop:"name",label:"名称",required:""}},[n("el-input",{attrs:{placeholder:"请输入资源名","auto-complete":"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name","string"==typeof t?t.trim():t)},expression:"form.name"}})],1),e._v(" "),n("el-form-item",{attrs:{prop:"type",label:"类型",required:""}},e._l(e.enums.ResourceTypeEnum,(function(t){return n("el-radio",{key:t.value,attrs:{disabled:e.typeDisabled,label:t.value},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[e._v(e._s(t.label))])})),1),e._v(" "),e.form.type===e.enums.ResourceTypeEnum.MENU.value?n("el-form-item",{attrs:{label:"样式"}},[n("el-input",{attrs:{placeholder:"请输入菜单图标样式"},model:{value:e.form.icon,callback:function(t){e.$set(e.form,"icon","string"==typeof t?t.trim():t)},expression:"form.icon"}})],1):e._e(),e._v(" "),e.form.type===e.enums.ResourceTypeEnum.MENU.value?n("el-form-item",{attrs:{prop:"code",label:"路由"}},[n("el-input",{attrs:{placeholder:"请输入路由code"},model:{value:e.form.url,callback:function(t){e.$set(e.form,"url","string"==typeof t?t.trim():t)},expression:"form.url"}})],1):e._e(),e._v(" "),n("el-form-item",{attrs:{prop:"code",label:"权限code"}},[n("el-input",{attrs:{placeholder:"请输入权限code"},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code","string"==typeof t?t.trim():t)},expression:"form.code"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"序号",prop:"weight",required:""}},[n("el-input",{attrs:{type:"number",placeholder:"请输入序号"},model:{value:e.form.weight,callback:function(t){e.$set(e.form,"weight","string"==typeof t?t.trim():t)},expression:"form.weight"}})],1)],1),e._v(" "),n("div",{staticClass:"dialog-footer",staticStyle:{"text-align":"center"}},[n("el-button",{attrs:{type:"primary",loading:e.btnLoading,size:"mini"},on:{click:e.btnOk}},[e._v("确 定")]),e._v(" "),n("el-button",{attrs:{size:"mini"},on:{click:e.cancel}},[e._v("取 消")])],1)],1)],1)}),[],!1,null,null,null).exports,m=n(237);function f(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw s}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var g={data:function(){return{enums:c.a,permission:m.b,showBtns:!1,rightClickData:{},dialogForm:{title:"",visible:!1,data:{},typeDisabled:!0},data:[],props:{label:"name",children:"children"},defaultExpandedKeys:[]}},methods:{deleteMenu:function(e){var t=this;this.$confirm("此操作将删除 [".concat(e.name,"], 是否继续?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){l.c.del.request({id:e.id}).then((function(e){t.$message.success("删除成功！"),t.search()}))}))},search:function(){var e=this;return a()(s.a.mark((function t(){var n;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.c.list.request();case 2:n=t.sent,e.data=n;case 4:case"end":return t.stop()}}),t)})))()},addResource:function(e){var t=this.dialogForm;t.visible=!0,t.data={};var n=c.a.ResourceTypeEnum.MENU.value,r=c.a.ResourceTypeEnum.PERMISSION.value;if(!e)return t.typeDisabled=!0,t.data.type=n,void(t.title="添加顶级菜单");if(t.data.pid=e.id,t.title="添加“"+e.name+"”的子资源 ",null===e.children||0===e.children.length)t.typeDisabled=!1;else{t.typeDisabled=!0;var s,o=!1,a=f(e.children);try{for(a.s();!(s=a.n()).done;){if(s.value.type===r){o=!0;break}}}catch(e){a.e(e)}finally{a.f()}t.data.type=o?r:n}},editResource:function(e){var t=this;return a()(s.a.mark((function n(){return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.dialogForm.visible=!0,n.next=3,l.c.detail.request({id:e.id});case 3:t.dialogForm.data=n.sent,t.dialogForm.typeDisabled=!0,t.dialogForm.title="修改“"+e.name+"”菜单";case 6:case"end":return n.stop()}}),n)})))()},valChange:function(e){this.search(),this.dialogForm.visible=!1},editorCancel:function(){this.dialogForm.visible=!1,this.dialogForm.data=null},changeStatus:function(e,t){var n=this;return a()(s.a.mark((function r(){return s.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,l.c.changeStatus.request({id:e.id,status:t});case 2:e.status=t,n.$message.success((1===t?"启用":"禁用")+"成功！");case 4:case"end":return r.stop()}}),r)})))()},handleNodeExpand:function(e,t){var n=t.data.id;this.defaultExpandedKeys.includes(n)||this.defaultExpandedKeys.push(n)},handleNodeCollapse:function(e,t){this.removeDeafultExpandId(t.data.id);var n,r=f(t.childNodes);try{for(r.s();!(n=r.n()).done;){var s=n.value;if(2==s.data.type)return;s.expanded&&this.removeDeafultExpandId(s.data.id),this.handleNodeCollapse(e,s)}}catch(e){r.e(e)}finally{r.f()}},removeDeafultExpandId:function(e){var t=this.defaultExpandedKeys.indexOf(e);t>-1&&this.defaultExpandedKeys.splice(t,1)},info:function(e){var t=this;return a()(s.a.mark((function n(){var r;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,l.c.detail.request({id:e.id});case 2:if((r=n.sent).type!==c.a.ResourceTypeEnum.MENU.value){n.next=6;break}return t.$alert('<strong style="margin-right: 18px">名称:</strong>'+r.name+' <br/><strong style="margin-right: 18px">图标:</strong>'+(r.icon?r.icon:"无")+' <br/><strong style="margin-right: 18px">路由:</strong>'+(r.url?r.url:"无")+' <br/><strong style="margin-right: 18px">权限code:</strong>'+(r.code?r.code:"无")+' <br/><strong style="margin-right: 18px">权重:</strong>'+r.weight+' <br/><strong style="margin-right: 18px">创建人:</strong>'+r.createAccount+' <br/><strong style="margin-right: 18px">创建时间:</strong>'+r.createTime+' <br/><strong style="margin-right: 18px">修改人:</strong>'+r.updateAccount+' <br/><strong style="margin-right: 18px">修改时间:</strong>'+r.updateTime,"菜单详情",{type:"info",dangerouslyUseHTMLString:!0,closeOnClickModal:!0,showConfirmButton:!1}).catch((function(e){})),n.abrupt("return");case 6:t.$alert('<strong style="margin-right: 18px">名称:</strong>'+r.name+' <br/><strong style="margin-right: 18px">权限code:</strong>'+(r.code?r.code:"无")+' <br/><strong style="margin-right: 18px">权重:</strong>'+r.weight+' <br/><strong style="margin-right: 18px">创建人:</strong>'+r.createAccount+' <br/><strong style="margin-right: 18px">创建时间:</strong>'+r.createTime+' <br/><strong style="margin-right: 18px">修改人:</strong>'+r.updateAccount+' <br/><strong style="margin-right: 18px">修改时间:</strong>'+r.updateTime,"权限详情",{type:"info",dangerouslyUseHTMLString:!0,closeOnClickModal:!0,showConfirmButton:!1}).catch((function(e){}));case 7:case"end":return n.stop()}}),n)})))()}},components:{ToolBar:i.a,ResourceEdit:p},mounted:function(){this.search()}},v=(n(740),Object(d.a)(g,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"menu"},[n("ToolBar",[n("div",[n("span",{staticStyle:{"font-size":"14px"}},[n("i",{staticClass:"el-icon-info"}),e._v("红色字体表示禁用状态\n      ")])]),e._v(" "),n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:e.permission.save.code,expression:"permission.save.code"}],attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:function(t){return e.addResource(!1)}}},[e._v("添加")])],1),e._v(" "),n("el-tree",{staticClass:"none-select",attrs:{indent:38,"node-key":"id",props:e.props,data:e.data,"default-expanded-keys":e.defaultExpandedKeys,"expand-on-click-node":!1},on:{"node-expand":e.handleNodeExpand,"node-collapse":e.handleNodeCollapse},scopedSlots:e._u([{key:"default",fn:function(t){t.node;var r=t.data;return n("span",{staticClass:"custom-tree-node"},[r.type===e.enums.ResourceTypeEnum.MENU.value?n("span",{staticStyle:{"font-size":"13px"}},[n("span",{staticStyle:{color:"#3c8dbc"}},[e._v("【")]),e._v("\n        "+e._s(r.name)+"\n        "),n("span",{staticStyle:{color:"#3c8dbc"}},[e._v("】")]),e._v(" "),null!==r.children?n("el-tag",{attrs:{size:"mini"}},[e._v(e._s(r.children.length))]):e._e()],1):e._e(),e._v(" "),r.type===e.enums.ResourceTypeEnum.PERMISSION.value?n("span",{staticStyle:{"font-size":"13px"}},[n("span",{staticStyle:{color:"#3c8dbc"}},[e._v("【")]),e._v(" "),n("span",{style:1==r.status?"color: #67c23a;":"color: #f67c6c;"},[e._v(e._s(r.name))]),e._v(" "),n("span",{staticStyle:{color:"#3c8dbc"}},[e._v("】")])]):e._e(),e._v(" "),n("el-link",{staticStyle:{"margin-left":"25px"},attrs:{icon:"el-icon-view",type:"info",underline:!1},on:{click:function(t){return e.info(r)}}}),e._v(" "),n("el-link",{directives:[{name:"permission",rawName:"v-permission",value:e.permission.update.code,expression:"permission.update.code"}],attrs:{type:"primary",icon:"el-icon-edit",underline:!1},on:{click:function(t){return e.editResource(r)}}}),e._v(" "),r.type===e.enums.ResourceTypeEnum.MENU.value?n("el-link",{directives:[{name:"permission",rawName:"v-permission",value:e.permission.save.code,expression:"permission.save.code"}],attrs:{icon:"el-icon-circle-plus-outline",underline:!1,type:"success"},on:{click:function(t){return e.addResource(r)}}}):e._e(),e._v(" "),1===r.status&&r.type===e.enums.ResourceTypeEnum.PERMISSION.value?n("el-link",{directives:[{name:"permission",rawName:"v-permission",value:e.permission.resource.code,expression:"permission.resource.code"}],attrs:{icon:"el-icon-circle-close",underline:!1,type:"warning"},on:{click:function(t){return e.changeStatus(r,0)}}}):e._e(),e._v(" "),0===r.status&&r.type===e.enums.ResourceTypeEnum.PERMISSION.value?n("el-link",{directives:[{name:"permission",rawName:"v-permission",value:e.permission.resource.code,expression:"permission.resource.code"}],attrs:{type:"success",icon:"el-icon-circle-check",underline:!1,plain:""},on:{click:function(t){return e.changeStatus(r,1)}}}):e._e(),e._v(" "),null==r.children?n("el-link",{directives:[{name:"permission",rawName:"v-permission",value:e.permission.del.code,expression:"permission.del.code"}],attrs:{type:"danger",icon:"el-icon-remove-outline",underline:!1,plain:""},on:{click:function(t){return e.deleteMenu(r)}}}):e._e()],1)}}])}),e._v(" "),n("ResourceEdit",{attrs:{title:e.dialogForm.title,dialogFormVisible:e.dialogForm.visible,data:e.dialogForm.data,typeDisabled:e.dialogForm.typeDisabled,departTree:e.data,type:e.dialogForm.type},on:{"val-change":e.valChange,cancel:function(t){return e.editorCancel()}}})],1)}),[],!1,null,null,null).exports)}}]);